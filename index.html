<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏£‡∏±‡∏ö‡∏ö‡∏±‡∏ï‡∏£ - EWP Service Center</title>
    <link rel="stylesheet" href="css/style.css?v=6.0">
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="header-left">
                <h1>‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏£‡∏±‡∏ö‡∏ö‡∏±‡∏ï‡∏£</h1>
                <p class="subtitle">‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£ EWP ‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£ One Bangkok</p>
            </div>
            <div class="header-right">
                <div class="user-info" id="userInfo">
                    <span class="user-name" id="currentUserName">-</span>
                    <span class="user-role" id="currentUserRole">-</span>
                </div>
                <button class="btn btn-outline btn-sm" id="userManagementBtn" style="display: none;">üë• ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ</button>
                <button class="btn btn-outline-danger btn-sm" id="logoutBtn">üö™ ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</button>
            </div>
        </header>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Left Panel - Form -->
            <section class="form-panel">
                <div class="form-panel-header">
                    <h2 id="formTitle">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡∏°‡πà</h2>
                    <span class="form-mode-badge" id="formModeBadge">‡πÇ‡∏´‡∏°‡∏î: ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÉ‡∏´‡∏°‡πà</span>
                </div>

                <!-- Import from VP API Button (hidden until API integration is ready) -->
                <div class="import-sheet-section" id="importSheetSection" style="display: none;">
                    <button type="button" class="btn btn-secondary btn-sm" id="importFromVPBtn">
                        üìã ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å VP
                    </button>
                    <span class="pending-badge" id="pendingBadge" style="display: none;">0</span>
                    <span class="sheet-status" id="vpStatus"></span>
                </div>

                <form id="receiptForm">
                    <!-- Hidden field for auto-generated receipt number -->
                    <input type="hidden" id="receiptNo">

                    <!-- Row 1: Date (Auto-generated) -->
                    <div class="form-group">
                        <label for="receiptDate">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ö‡∏ö‡∏±‡∏ï‡∏£ (Date) <span class="auto-badge">‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥</span></label>
                        <input type="date" id="receiptDate" required readonly class="readonly-field">
                    </div>

                    <!-- Row 2: Name -->
                    <div class="form-group">
                        <label for="foreignerName">‡∏ä‡∏∑‡πà‡∏≠‡∏Ñ‡∏ô‡∏ï‡πà‡∏≤‡∏á‡∏î‡πâ‡∏≤‡∏ß (Name)</label>
                        <input type="text" id="foreignerName" placeholder="RAFAEL MASSAYOSHI NIITSUMA" required>
                    </div>

                    <!-- Row 3: SN Card Number -->
                    <div class="form-group">
                        <label for="snNumber">‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç SN ‡∏ö‡∏±‡∏ï‡∏£ (SN Number)</label>
                        <input type="text" id="snNumber" placeholder="1234567890">
                    </div>

                    <!-- Row 4: Request No -->
                    <div class="form-group">
                        <label for="requestNo">‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏Ñ‡∏≥‡∏Ç‡∏≠ (Request No.)</label>
                        <input type="text" id="requestNo" placeholder="B69113800005272" required>
                    </div>

                    <!-- Row 5: Appointment No -->
                    <div class="form-group">
                        <label for="appointmentNo">‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡πÉ‡∏ö‡∏ô‡∏±‡∏î‡∏´‡∏°‡∏≤‡∏¢ (Appointment No.)</label>
                        <input type="text" id="appointmentNo" placeholder="1-BKK001022600639-SW" required>
                    </div>

                    <!-- Divider -->
                    <hr class="divider">

                    <!-- Image Upload Section -->
                    <div class="form-group">
                        <label>‡∏£‡∏π‡∏õ‡∏ö‡∏±‡∏ï‡∏£ Work Permit (‡∏´‡∏ô‡πâ‡∏≤-‡∏´‡∏•‡∏±‡∏á)</label>
                        <div class="image-upload-single" id="cardImageUpload">
                            <input type="file" id="cardImage" accept="image/*" hidden>
                            <div class="upload-placeholder" id="cardPlaceholder">
                                <span class="upload-icon">üì∑</span>
                                <span>‡∏£‡∏π‡∏õ‡∏ö‡∏±‡∏ï‡∏£ Work Permit</span>
                                <span class="upload-hint">‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏π‡∏õ, ‡∏•‡∏≤‡∏Å‡πÑ‡∏ü‡∏•‡πå‡∏°‡∏≤‡∏ß‡∏≤‡∏á ‡∏´‡∏£‡∏∑‡∏≠ Ctrl+V</span>
                            </div>
                            <img id="cardPreview" class="image-preview" alt="Card">
                        </div>
                    </div>

                    <!-- Action Buttons -->
                    <div class="form-actions">
                        <button type="button" class="btn btn-outline-danger" id="clearBtn">üóëÔ∏è ‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
                        <button type="button" class="btn btn-primary" id="saveBtn">üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
                    </div>
                    <div class="form-actions-secondary">
                        <button type="button" class="btn btn-success" id="printBtn">üñ®Ô∏è ‡∏û‡∏¥‡∏°‡∏û‡πå‡πÉ‡∏ö‡∏£‡∏±‡∏ö</button>
                    </div>
                </form>
            </section>

            <!-- Right Panel - Preview -->
            <section class="preview-panel">
                <h2>‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÉ‡∏ö‡∏£‡∏±‡∏ö</h2>
                <div class="receipt-preview" id="receiptPreview">
                    <!-- Receipt Template -->
                    <div class="receipt-document">
                        <div class="receipt-header">
                            <h3>‡πÅ‡∏ö‡∏ö‡∏£‡∏±‡∏ö‡πÉ‡∏ö‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï‡∏ó‡∏≥‡∏á‡∏≤‡∏ô e-WorkPermit</h3>
                            <p>(e-WorkPermit Card Receipt)</p>
                        </div>

                        <div class="receipt-body">
                            <div class="receipt-row">
                                <span class="label">
                                    <span class="label-th">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ö‡∏ö‡∏±‡∏ï‡∏£:</span>
                                    <span class="label-en">(Date)</span>
                                </span>
                                <span class="value" id="previewDate">-</span>
                            </div>
                            <div class="receipt-row">
                                <span class="label">
                                    <span class="label-th">‡∏ä‡∏∑‡πà‡∏≠:</span>
                                    <span class="label-en">(Name)</span>
                                </span>
                                <span class="value" id="previewName">-</span>
                            </div>
                            <div class="receipt-row">
                                <span class="label">
                                    <span class="label-th">‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç SN:</span>
                                    <span class="label-en">(Serial No.)</span>
                                </span>
                                <span class="value" id="previewSN">-</span>
                            </div>
                            <div class="receipt-row">
                                <span class="label">
                                    <span class="label-th">‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏Ñ‡∏≥‡∏Ç‡∏≠:</span>
                                    <span class="label-en">(Request No.)</span>
                                </span>
                                <span class="value" id="previewRequestNo">-</span>
                            </div>
                            <div class="receipt-row">
                                <span class="label">
                                    <span class="label-th">‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡πÉ‡∏ö‡∏ô‡∏±‡∏î‡∏´‡∏°‡∏≤‡∏¢:</span>
                                    <span class="label-en">(Appointment No.)</span>
                                </span>
                                <span class="value" id="previewAppointmentNo">-</span>
                            </div>
                        </div>
                        <!-- Hidden element for receipt number -->
                        <span id="previewReceiptNo" style="display:none;"></span>

                        <div class="receipt-images-single">
                            <div class="receipt-image-box-single" id="previewCardBox">
                                <span class="image-label">‡∏£‡∏π‡∏õ‡∏ö‡∏±‡∏ï‡∏£ Work Permit</span>
                                <img id="receiptCardImage" alt="Card">
                            </div>
                        </div>

                        <div class="receipt-confirmation">
                            <p class="confirmation-text-th">‡∏Ç‡πâ‡∏≤‡∏û‡πÄ‡∏à‡πâ‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏Ç‡∏≠‡∏á‡πÉ‡∏ö‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÅ‡∏•‡πâ‡∏ß ‡πÅ‡∏•‡∏∞‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ß‡πà‡∏≤‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡πÉ‡∏ö‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï‡∏ó‡∏≥‡∏á‡∏≤‡∏ô ‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏ß‡∏µ‡∏ã‡πà‡∏≤‡πÅ‡∏•‡∏∞‡πÉ‡∏ö‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï‡∏ó‡∏≥‡∏á‡∏≤‡∏ô ‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£ One Bangkok.</p>
                            <p class="confirmation-text-en">I have checked that all the information on the card is correct. and confirm that you received the card at One Stop Service Center at One Bangkok.</p>
                        </div>

                        <div class="receipt-footer">
                            <div class="signature-box">
                                <div class="signature-line"></div>
                                <p>‡∏•‡∏á‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡∏ö‡∏±‡∏ï‡∏£ / Cardholder Signature</p>
                                <p class="signer-name" id="previewSignerName">-</p>
                            </div>
                            <div class="signature-box">
                                <div class="signature-line"></div>
                                <p>‡∏•‡∏á‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà / Officer Signature</p>
                                <p class="signer-name">&nbsp;</p>
                            </div>
                        </div>

                        <!-- Footer with Org Name and Doc No -->
                        <div class="receipt-bottom-footer">
                            <div class="footer-org">‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£ EWP ‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£ One Bangkok</div>
                            <div class="footer-doc">Doc No.: <span id="previewDocNo">-</span></div>
                        </div>
                    </div>
                </div>
            </section>
        </main>

        <!-- Daily Summary Panel -->
        <section class="summary-panel">
            <div class="summary-header">
                <h2>üìä ‡∏™‡∏£‡∏∏‡∏õ‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô</h2>
                <div class="summary-controls">
                    <input type="date" id="summaryDate" class="summary-date-input">
                    <button class="btn btn-outline btn-sm" id="exportCsvBtn">üìä Export CSV</button>
                    <button class="btn btn-outline btn-sm" id="exportPdfBtn">üìÑ Export PDF</button>
                </div>
            </div>
            <div class="summary-cards" id="summaryCards">
                <div class="summary-card">
                    <div class="summary-icon">üìù</div>
                    <div class="summary-number" id="summaryTotal">0</div>
                    <div class="summary-label">‡∏ú‡∏•‡∏¥‡∏ï‡∏ö‡∏±‡∏ï‡∏£‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</div>
                </div>
                <div class="summary-card printed">
                    <div class="summary-icon">‚úÖ</div>
                    <div class="summary-number" id="summaryPrinted">0</div>
                    <div class="summary-label">‡∏û‡∏¥‡∏°‡∏û‡πå‡πÉ‡∏ö‡∏£‡∏±‡∏ö‡πÅ‡∏•‡πâ‡∏ß</div>
                </div>
                <div class="summary-card pending">
                    <div class="summary-icon">‚è≥</div>
                    <div class="summary-number" id="summaryPendingPrint">0</div>
                    <div class="summary-label">‡∏£‡∏≠‡∏û‡∏¥‡∏°‡∏û‡πå‡πÉ‡∏ö‡∏£‡∏±‡∏ö</div>
                </div>
                <div class="summary-card received">
                    <div class="summary-icon">üé´</div>
                    <div class="summary-number" id="summaryReceived">0</div>
                    <div class="summary-label">‡∏£‡∏±‡∏ö‡∏ö‡∏±‡∏ï‡∏£‡πÅ‡∏•‡πâ‡∏ß</div>
                </div>
                <div class="summary-card waiting">
                    <div class="summary-icon">üì¶</div>
                    <div class="summary-number" id="summaryWaiting">0</div>
                    <div class="summary-label">‡∏£‡∏≠‡∏£‡∏±‡∏ö‡∏ö‡∏±‡∏ï‡∏£</div>
                </div>
            </div>
        </section>

        <!-- Data Panel - Registry List -->
        <section class="data-panel">
            <div class="data-header">
                <h2>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡πÅ‡∏ö‡∏ö‡∏£‡∏±‡∏ö‡πÉ‡∏ö‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï‡∏ó‡∏≥‡∏á‡∏≤‡∏ô e-WorkPermit</h2>
                <div class="data-controls">
                    <!-- Add New Button -->
                    <button class="btn btn-success btn-sm" id="addNewBtn">‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡∏°‡πà</button>
                    <!-- Batch Print Button -->
                    <button class="btn btn-primary btn-sm" id="batchPrintBtn" disabled>üñ®Ô∏è ‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å (<span id="selectedCount">0</span>)</button>
                    <!-- Search -->
                    <div class="search-box">
                        <input type="text" id="searchInput" placeholder="üîç ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ ‡πÄ‡∏•‡∏Ç‡∏£‡∏±‡∏ö‡∏ó‡∏µ‡πà, SN, ‡∏ä‡∏∑‡πà‡∏≠..." class="search-input">
                    </div>
                    <!-- Filter -->
                    <select id="filterStatus" class="filter-select">
                        <option value="all">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</option>
                        <option value="printed">‚úÖ ‡∏û‡∏¥‡∏°‡∏û‡πå‡πÅ‡∏•‡πâ‡∏ß</option>
                        <option value="not-printed">‚è≥ ‡∏£‡∏≠‡∏û‡∏¥‡∏°‡∏û‡πå</option>
                        <option value="received">üé´ ‡∏£‡∏±‡∏ö‡∏ö‡∏±‡∏ï‡∏£‡πÅ‡∏•‡πâ‡∏ß</option>
                        <option value="not-received">üì¶ ‡∏£‡∏≠‡∏£‡∏±‡∏ö‡∏ö‡∏±‡∏ï‡∏£</option>
                    </select>
                    <button class="btn btn-outline btn-sm" id="refreshDataBtn">üîÑ ‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä</button>
                </div>
            </div>
            <div class="table-container">
                <table id="registryTable">
                    <thead>
                        <tr>
                            <th><input type="checkbox" id="selectAllCheckbox" title="‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î"></th>
                            <th>‡∏•‡∏≥‡∏î‡∏±‡∏ö</th>
                            <th>‡πÄ‡∏•‡∏Ç‡∏£‡∏±‡∏ö‡∏ó‡∏µ‡πà</th>
                            <th>SN ‡∏ö‡∏±‡∏ï‡∏£</th>
                            <th>‡∏ä‡∏∑‡πà‡∏≠</th>
                            <th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</th>
                            <th>‡∏£‡∏π‡∏õ</th>
                            <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏û‡∏¥‡∏°‡∏û‡πå</th>
                            <th>‡∏£‡∏±‡∏ö‡∏ö‡∏±‡∏ï‡∏£</th>
                            <th>‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</th>
                        </tr>
                    </thead>
                    <tbody id="registryBody">
                        <!-- Data will be loaded here -->
                        <tr class="loading-row">
                            <td colspan="10">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>
    </div>

        <!-- Reports Tab Section -->
        <section class="reports-section" id="reportsSection">
            <!-- Tab Navigation -->
            <div class="tab-navigation">
                <button class="tab-btn active" data-tab="monthlyReport" id="tabMonthlyReport">
                    üìÖ ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô
                </button>
                <button class="tab-btn" data-tab="activityLog" id="tabActivityLog">
                    üìã Activity Log
                </button>
            </div>

            <!-- Tab Content -->
            <div class="tab-content">
                <!-- Monthly Report Tab -->
                <div class="tab-pane active" id="monthlyReportPane">
                    <div class="monthly-header">
                        <div class="monthly-controls">
                            <select id="reportMonth" class="filter-select">
                                <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏î‡∏∑‡∏≠‡∏ô --</option>
                            </select>
                            <select id="reportYear" class="filter-select">
                                <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏µ --</option>
                            </select>
                            <button class="btn btn-primary btn-sm" id="generateReportBtn">üìä ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</button>
                            <button class="btn btn-outline btn-sm" id="exportMonthlyPdfBtn">üìÑ Export PDF</button>
                            <button class="btn btn-outline btn-sm" id="exportMonthlyCsvBtn">üìä Export CSV</button>
                        </div>
                    </div>
                    <div class="monthly-summary" id="monthlySummary">
                        <div class="monthly-stats">
                            <div class="stat-card">
                                <div class="stat-number" id="monthlyTotal">0</div>
                                <div class="stat-label">‡∏ú‡∏•‡∏¥‡∏ï‡∏ö‡∏±‡∏ï‡∏£‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</div>
                            </div>
                            <div class="stat-card success">
                                <div class="stat-number" id="monthlyPrinted">0</div>
                                <div class="stat-label">‡∏û‡∏¥‡∏°‡∏û‡πå‡πÉ‡∏ö‡∏£‡∏±‡∏ö‡πÅ‡∏•‡πâ‡∏ß</div>
                            </div>
                            <div class="stat-card info">
                                <div class="stat-number" id="monthlyReceived">0</div>
                                <div class="stat-label">‡∏£‡∏±‡∏ö‡∏ö‡∏±‡∏ï‡∏£‡πÅ‡∏•‡πâ‡∏ß</div>
                            </div>
                            <div class="stat-card warning">
                                <div class="stat-number" id="monthlyPending">0</div>
                                <div class="stat-label">‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</div>
                            </div>
                        </div>
                        <div class="daily-breakdown" id="dailyBreakdown">
                            <!-- Will be populated by JavaScript -->
                        </div>
                    </div>
                </div>

                <!-- Activity Log Tab -->
                <div class="tab-pane" id="activityLogPane">
                    <div class="activity-header">
                        <div class="activity-controls">
                            <select id="activityFilter" class="filter-select">
                                <option value="all">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</option>
                                <option value="add">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</option>
                                <option value="edit">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</option>
                                <option value="delete">‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</option>
                                <option value="print">‡∏û‡∏¥‡∏°‡∏û‡πå‡πÉ‡∏ö‡∏£‡∏±‡∏ö</option>
                                <option value="receive">‡∏£‡∏±‡∏ö‡∏ö‡∏±‡∏ï‡∏£</option>
                            </select>
                            <button class="btn btn-outline-danger btn-sm" id="clearLogBtn">üóëÔ∏è ‡∏•‡πâ‡∏≤‡∏á Log</button>
                        </div>
                    </div>
                    <div class="activity-list" id="activityList">
                        <div class="activity-empty">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ Activity</div>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <!-- Print Template (Hidden) -->
    <div id="printTemplate" class="print-only">
        <!-- Will be populated by JavaScript -->
    </div>

    <!-- User Management Modal -->
    <div class="modal-overlay" id="userModalOverlay" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="userModalTitle">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ</h3>
                <button class="modal-close" id="closeUserModal">&times;</button>
            </div>
            <div class="modal-body" id="userModalBody">
                <!-- Content will be loaded dynamically -->
            </div>
        </div>
    </div>

    <!-- Pending Receipts from VP Modal -->
    <div class="modal-overlay" id="pendingModalOverlay" style="display: none;">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h3>üìã ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å VP</h3>
                <button class="modal-close" id="closePendingModal">&times;</button>
            </div>
            <div class="modal-body">
                <!-- Search Section -->
                <div class="sheet-search-section">
                    <div class="search-row">
                        <input type="text" id="pendingSearchInput" placeholder="üîç ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏î‡πâ‡∏ß‡∏¢ ‡πÄ‡∏•‡∏Ç‡∏Ñ‡∏≥‡∏Ç‡∏≠, ‡∏ä‡∏∑‡πà‡∏≠, ‡πÄ‡∏•‡∏Ç‡∏ô‡∏±‡∏î‡∏´‡∏°‡∏≤‡∏¢..." class="search-input-large">
                        <button type="button" class="btn btn-primary" id="pendingSearchBtn">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</button>
                        <button type="button" class="btn btn-outline" id="pendingRefreshBtn">üîÑ ‡πÇ‡∏´‡∏•‡∏î‡πÉ‡∏´‡∏°‡πà</button>
                    </div>
                    <div class="search-info">
                        <span id="pendingDataInfo">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</span>
                    </div>
                </div>

                <!-- Results Table -->
                <div class="sheet-results-container">
                    <table class="sheet-results-table" id="pendingResultsTable">
                        <thead>
                            <tr>
                                <th>‡∏•‡∏≥‡∏î‡∏±‡∏ö</th>
                                <th>‡∏ä‡∏∑‡πà‡∏≠</th>
                                <th>‡πÄ‡∏•‡∏Ç‡∏Ñ‡∏≥‡∏Ç‡∏≠</th>
                                <th>‡πÄ‡∏•‡∏Ç‡∏ô‡∏±‡∏î‡∏´‡∏°‡∏≤‡∏¢</th>
                                <th>‡∏£‡∏π‡∏õ‡∏ñ‡πà‡∏≤‡∏¢</th>
                                <th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ö</th>
                                <th>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å</th>
                            </tr>
                        </thead>
                        <tbody id="pendingResultsBody">
                            <tr><td colspan="7" class="loading-cell">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script>
        // Initialize Supabase before other scripts
        function initSupabase() {
            const SUPABASE_URL = 'https://pyyltrcqeyfhidpcdtvc.supabase.co';
            const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InB5eWx0cmNxZXlmaGlkcGNkdHZjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzAyMjE0MzcsImV4cCI6MjA4NTc5NzQzN30.vRJk8x6Kmo2rFYrJ6ZGqPWf3LSjLmb41COLJAP5glYo';

            if (window.supabase && window.supabase.createClient && !window.supabaseClient) {
                window.supabaseClient = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
                console.log('‚úÖ Supabase initialized');
                return true;
            }
            return !!window.supabaseClient;
        }

        // Try to init immediately
        if (!initSupabase()) {
            setTimeout(initSupabase, 100);
        }
    </script>
    <script src="js/supabase-config.js?v=6.0"></script>
    <script src="js/supabase-adapter.js?v=6.0"></script>
    <script src="js/auth.js?v=6.0"></script>
    <script src="js/app-supabase.js?v=6.0"></script>
</body>
</html>
